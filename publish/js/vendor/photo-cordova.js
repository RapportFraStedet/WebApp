$(function(){$.widget("custom.photo",{options:{imageSizeValue:100,imageQualityValue:100,id:"",required:!1,name:"",permission:2},_create:function(){this.imageSizeValue=this.options.imageSizeValue;this.imageQualityValue=this.options.imageQualityValue;var a=$("<div>",{"data-role":"fieldcontain"});this.element.append(a);var b=this._createLabel().addClass("ui-input-text");a.append(b);a=$("<div class='cameraButtons'>").appendTo(a);this.fotoalbum=$("<input type='button' value='Fotoalbum'>").appendTo(a).button({inline:!0});
this.options.permission==1&&this.fotoalbum.button("disable");this._on(this.fotoalbum,{click:function(){navigator.camera.getPicture(function(){return function(a){this.resultFile=a;this._changeImage()}}(this),function(a){navigator.notification.alert("Der er sket en fejl: "+a,null,"Fejl")},{quality:100,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY})}});this.kamera=$("<input type='button' value='Kamera'>").appendTo(a).button({inline:!0});this.options.permission==
1&&this.kamera.button("disable");this._on(this.kamera,{click:function(){navigator.camera.getPicture(function(){return function(a){this.resultFile=a;this._changeImage()}}(this),function(a){navigator.notification.alert("Der er sket en fejl: "+a,null,"Fejl")},{quality:100,destinationType:Camera.DestinationType.DATA_URL})}});if(Rfs.editImage)b=$("<div data-role='collapsible'>").appendTo(a),$("<h4>Options</h4>").appendTo(b),this.textSize=$("<div>").appendTo(b),$("<label for='imageSize-"+this.options.id+
"'>Billede st\u00f8rrelse</label>").appendTo(b),this.imageSize=$("<input type='number' data-type='range' name='imageSize-"+this.options.id+"' id='imageSize-"+this.options.id+"' min='0' max='100' value='"+this.options.imageSizeValue+"' data-highlight='true'/>").appendTo(b).slider(),this._on(this.imageSize,{slidestop:function(){this.imageSizeValue=this.imageSize.val();this._changeImage()},keyup:function(){this.imageSizeValue=this.imageSize.val();this._changeImage()}}),$("<label for='imageQuality-"+
this.options.id+"'>Billede kvalitet</label>").appendTo(b),this.imageQuality=$("<input type='number' data-type='range' name='imageQuality-"+this.options.id+"' id='imageQuality-"+this.options.id+"' min='0' max='100' value='"+this.options.imageQualityValue+"' data-highlight='true'/>").appendTo(b).slider(),this._on(this.imageQuality,{slidestop:function(){this.imageQualityValue=this.imageQuality.val();this._changeImage()},keyup:function(){this.imageQualityValue=this.imageQuality.val();this._changeImage()}});
this.hidden=$("<input type='hidden' id='"+this.options.id+"' name='"+this.options.id+"' val=''/>").appendTo(this.element);this.options.required==1&&this.hidden.addClass("required");this.imageA=$("<img id='A"+this.options.id+"' width='100%'/>").appendTo(a).hide()},_createLabel:function(){var a=null;return a=this.options.required==1?$("<label for='"+this.options.id+"'><em>*</em>"+this.options.name+"</label>"):$("<label for='"+this.options.id+"'>"+this.options.name+"</label>")},_changeImage:function(){canvasResize(this.resultFile,
{scale:this.imageSizeValue,quality:this.imageQualityValue,callback:function(a){return function(b,c,d){a.imageA.attr("src",b).css("display","inline");a.hidden.val(b);b=b.split(",")[1];si=atob(b).length;si>1E6?a.textSize.text((si/1048576).toFixed(1)+" Mb, "+c+"\u2613"+d):si>1E3&&a.textSize.text(Math.round(si/1024)+" Kb, "+c+"\u2613"+d);c<$(".cameraButtons").width()?a.imageA.width(c):a.imageA.css("width","100%")}}(this)})},_destroy:function(){},_setOptions:function(){this._superApply(arguments);this._refresh()},
_setOption:function(a,b){this._super(a,b)}})});
