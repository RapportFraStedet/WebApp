$(function(){$.widget("custom.photo",{options:{imageSizeValue:100,imageQualityValue:100,id:"",required:!1,name:"",permission:2},_create:function(){this.imageSizeValue=this.options.imageSizeValue;this.imageQualityValue=this.options.imageQualityValue;var a=$("<div>",{"data-role":"fieldcontain"});this.element.append(a);var b=this._createLabel().addClass("ui-input-text");a.append(b);a=$("<div class='cameraButtons'>").appendTo(a);this.fotoalbum=$("<input type='button' value='Fotoalbum'>").appendTo(a).button({inline:!0});
this.options.permission==1&&this.fotoalbum.button("disable");this._on(this.fotoalbum,{click:function(){var a={quality:100,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY};if(!Rfs.editImage)a.destinationType=Camera.DestinationType.FILE_URI;navigator.camera.getPicture(function(a){return function(b){Rfs.editImage?(a.resultFile="data:image/jpeg;base64,"+b,a._changeImage()):(a.imageA.attr("src",b).css("display","inline").addClass("imageCamera"),a.hidden.val("data:image/jpg;base64,"))}}(this),
function(a){navigator.notification.alert("Der er sket en fejl: "+a,null,"Fejl")},a)}});this.kamera=$("<input type='button' value='Kamera'>").appendTo(a).button({inline:!0});this.options.permission==1&&this.kamera.button("disable");this._on(this.kamera,{click:function(){var a={quality:100,destinationType:Camera.DestinationType.DATA_URL};if(!Rfs.editImage)a.destinationType=Camera.DestinationType.FILE_URI;navigator.camera.getPicture(function(a){return function(b){Rfs.editImage?(a.resultFile="data:image/jpeg;base64,"+
b,a._changeImage()):(a.imageA.attr("src",b).css("display","inline").addClass("imageCamera"),a.hidden.val("data:image/jpg;base64,"))}}(this),function(a){navigator.notification.alert("Der er sket en fejl: "+a,null,"Fejl")},a)}});if(Rfs.editImage)b=$("<div data-role='collapsible'>").appendTo(a),$("<h4>Options</h4>").appendTo(b),this.textSize=$("<div>").appendTo(b),$("<label for='imageSize-"+this.options.id+"'>Billede st\u00f8rrelse</label>").appendTo(b),this.imageSize=$("<input type='number' data-type='range' name='imageSize-"+
this.options.id+"' id='imageSize-"+this.options.id+"' min='0' max='100' value='"+this.options.imageSizeValue+"' data-highlight='true'/>").appendTo(b).slider(),this._on(this.imageSize,{slidestop:function(){this.imageSizeValue=this.imageSize.val();this._changeImage()},keyup:function(){this.imageSizeValue=this.imageSize.val();this._changeImage()}}),$("<label for='imageQuality-"+this.options.id+"'>Billede kvalitet</label>").appendTo(b),this.imageQuality=$("<input type='number' data-type='range' name='imageQuality-"+
this.options.id+"' id='imageQuality-"+this.options.id+"' min='0' max='100' value='"+this.options.imageQualityValue+"' data-highlight='true'/>").appendTo(b).slider(),this._on(this.imageQuality,{slidestop:function(){this.imageQualityValue=this.imageQuality.val();this._changeImage()},keyup:function(){this.imageQualityValue=this.imageQuality.val();this._changeImage()}});this.hidden=$("<input type='hidden' id='"+this.options.id+"' name='"+this.options.id+"' val=''/>").appendTo(this.element);this.options.required==
1&&this.hidden.addClass("required");this.imageA=$("<img id='A"+this.options.id+"' width='100%'/>").appendTo(a).hide()},_createLabel:function(){var a=null;return a=this.options.required==1?$("<label for='"+this.options.id+"'><em>*</em>"+this.options.name+"</label>"):$("<label for='"+this.options.id+"'>"+this.options.name+"</label>")},_changeImage:function(){canvasResize(this.resultFile,{scale:this.imageSizeValue,quality:this.imageQualityValue,callback:function(a){return function(b,d,e){a.imageA.attr("src",
b).css("display","inline").removeClass("imageCamera");a.hidden.val(b);var c=b.split(","),b="";if(c.length>0)c=atob(c[1]).length,c>1E6?b=(c/1048576).toFixed(1)+" Mb, ":c>1E3&&(b=Math.round(c/1024)+" Kb, ");a.textSize.text(b+d+"\u2613"+e);d<$(".cameraButtons").width()?a.imageA.width(d):a.imageA.css("width","100%")}}(this)})},_destroy:function(){},_setOptions:function(){this._superApply(arguments);this._refresh()},_setOption:function(a,b){this._super(a,b)}})});
